From: Aron Xu <aron@debian.org>
Date: Sat, 24 Jan 2015 09:08:09 +0800
Subject: fix libsystemd support

---
 configure.ac    | 2 +-
 src/Makefile.am | 2 +-
 src/main.c      | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/configure.ac b/configure.ac
index 732a277..84df97f 100644
--- a/configure.ac
+++ b/configure.ac
@@ -319,7 +319,7 @@ AC_ARG_ENABLE(systemd,
 
 if [ test "$systemd_enabled" = "yes" ];then
 AC_LIB_HAVE_LINKFLAGS(systemd,, [#include <systemd/sd-daemon.h>], [sd_listen_fds(0);])
- if [ test -z "$LIBSYSTEMD_DAEMON" ];then
+ if [ test -z "$LIBSYSTEMD" ];then
 	systemd_enabled="no"
  else
 	systemd_enabled="yes"
diff --git a/src/Makefile.am b/src/Makefile.am
index 88f7d22..bd568d4 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -89,7 +89,7 @@ ocserv_SOURCES += ipc.pb-c.h ipc.pb-c.c ctl.pb-c.c ctl.pb-c.h
 ocserv_LDADD = ../gl/libgnu.a $(NEEDED_LIBOPTS) libcmd-ocserv.a
 ocserv_LDADD += $(LIBGNUTLS_LIBS) $(PAM_LIBS) $(LIBUTIL) \
 	$(LIBSECCOMP) $(LIBWRAP) $(LIBCRYPT) $(NEEDED_HTTP_PARSER_LIBS) \
-	$(LIBPROTOBUF_C_LIBS) $(LIBSYSTEMD_DAEMON) $(LIBTALLOC_LIBS) \
+	$(LIBPROTOBUF_C_LIBS) $(LIBSYSTEMD) $(LIBTALLOC_LIBS) \
 	$(FREERADIUS_CLIENT_LIBS) $(LIBLZ4_LIBS)
 
 
diff --git a/src/main.c b/src/main.c
index d161634..5b93f14 100644
--- a/src/main.c
+++ b/src/main.c
@@ -47,7 +47,7 @@
 # include <tcpd.h>
 #endif
 
-#ifdef HAVE_LIBSYSTEMD_DAEMON
+#ifdef HAVE_LIBSYSTEMD
 # include <systemd/sd-daemon.h>
 #endif
 #include <main.h>
@@ -278,7 +278,7 @@ listen_ports(void *pool, struct cfg_st* config,
 	list_head_init(&list->head);
 	list->total = 0;
 
-#ifdef HAVE_LIBSYSTEMD_DAEMON
+#ifdef HAVE_LIBSYSTEMD
 	/* Support for systemd socket-activatable service */
 	if ((fds=sd_listen_fds(0)) > 0) {
 		/* if we get our fds from systemd */
